# WeActive Web 开发文档 (内部)

该接口文档仅限内部开发参考，切勿泄露。

## Server API接口

### 短信验证

#### 接口请求

| 接口说明     | 短信验证：向目标手机发送验证码                               |
| :--------------- | :------------------------ |
| **请求方法** | POST |
| **请求地址** | http://119.3.159.148:12345/phone/ |

#### 接口请求示例

```javascript
$.ajax({
    url: serverURL + "/phone/",
    data: {"Phone": "18751453541"},
    type: "POST",
    dataType: "json",
    success: function(resp) {
        let Code = resp["Code"];
        if(Code === 1001){
            alert("此IP请求已达上限");
        }
    }
});
```

#### 接口响应参数

| 参数名称 | 类型   | 参数说明                                                     |
| :------- | :----- | :----------------------------------------------------------- |
| Code     | int    | **1000：验证成功**<br />1001：此IP请求达到上限，拒绝发送<br />1002：该手机号已被注册<br />1003：手机号格式不正确<br />2000：接口内部错误 |
| Message  | string | 当Code=2000时，附加的错误代码。                              |



### 注册验证

#### 接口请求

| 接口说明     | 注册验证：核对注册信息并予以注册      |
| :----------- | :------------------------------------ |
| **请求方法** | POST                                  |
| **请求地址** | https://119.3.159.148:12345/register/ |

#### 接口请求示例

```javascript
$.ajax({
    url: serverURL + "/register/",
    xhrFields: {withCredentials: true},
    data: {"Phone": "18726152535", "Code":"237822", "Password":"Aa123456"},
    type: "POST",
    dataType: "json",
    success: function(resp) {
        let Code = resp["Code"];
        if(Code === 1000){
            //...
        }
    }
});
```

#### 接口响应参数

| 参数名称 | 类型 | 参数说明                                                     |
| :------- | :--- | :----------------------------------------------------------- |
| Code     | int  | **1000：注册成功**<br />1001：密码格式不正确<br />1002：短信验证码错误<br />1003：手机号已被注册 |



### 快速身份验证

#### 接口请求

| 接口说明     | 身份验证：根据携带的SID Cookie验证身份                       |
| :----------- | :----------------------------------------------------------- |
| **请求方法** | POST                                                         |
| **请求格式** | Content-Type: application/x-www-form-urlencoded; charset=UTF-8 |
| **请求地址** | https://119.3.159.148:12345/verify/                          |

#### 接口请求示例

使用前端的拦截器（装饰器）完成：`@login_required`

#### 接口响应参数

| 参数名称 | 类型 | 参数说明                                       |
| :------- | :--- | :--------------------------------------------- |
| Code     | int  | **1000：身份验证成功**<br />1001：身份验证失败 |



### 登录验证

#### 接口请求

| 接口说明     | 登录验证：根据账号密码验证身份                               |
| :----------- | :----------------------------------------------------------- |
| **传输方式** | https                                                        |
| **请求格式** | Content-Type: application/x-www-form-urlencoded; charset=UTF-8 |
| **请求地址** | https://119.3.159.148:12345/login/                           |

#### 接口请求示例

```javascript
...
```

#### 接口响应参数

| 参数名称     | 类型         | 参数说明                                       |
| :----------- | :----------- | :--------------------------------------------- |
| Code         | int          | **1000：身份验证成功**<br />1001：身份验证失败 |
| (Cookie:sid) | cookie       | 签发新的Cookie                                 |
| wjx_set      | string(JSON) | 用户隐私信息（问卷星代填设置）                 |



### 注销身份

#### 接口请求

| 接口说明     | 注销身份：注销签发Cookie                                     |
| :----------- | :----------------------------------------------------------- |
| **传输方式** | https                                                        |
| **请求方法** | POST                                                         |
| **请求格式** | Content-Type: application/x-www-form-urlencoded; charset=UTF-8 |
| **请求地址** | https://119.3.159.148:12345/logout/                          |
| **响应格式** | JSON                                                         |

#### 接口请求参数

| 参数名称     | 类型   | 是否必填 | 参数说明         |
| :----------- | :----- | :------- | :--------------- |
| (Cookie:SID) | cookie | 是       | 携带的SID Cookie |

#### 接口响应参数

| 参数名称 | 类型 | 参数说明                               |
| :------- | :--- | :------------------------------------- |
| Code     | int  | **1000：注销成功**<br />1001：注销失败 |



### 问卷星预生成订单

#### 接口请求

| 接口说明     | 问卷星图片上传：检查图片的合法性并创建订单                   |
| :----------- | :----------------------------------------------------------- |
| **传输方式** | https                                                        |
| **请求方法** | POST                                                         |
| **请求格式** | Content-Type: application/x-www-form-urlencoded; charset=UTF-8 |
| **请求地址** | https://119.3.159.148:12345/wjx_order_pre/                   |
| **响应格式** | JSON                                                         |

#### 接口请求参数

| 参数名称     | 类型     | 是否必填 | 参数说明         |
| :----------- | :------- | :------- | :--------------- |
| (Cookie:SID) | cookie   | 是       | 携带的SID Cookie |
| formdata     | formdata | 是       | 二维码图片数据流 |

#### 接口响应参数

| 参数名称 | 类型   | 参数说明                                                     |
| :------- | :----- | :----------------------------------------------------------- |
| Code     | int    | **1000：订单成功**<br />1001：识别失败<br />2000：身份验证失败 |
| Message  | string | 识别失败时附加的报错信息                                     |
| order    | string | 订单相关信息的JSON对象                                       |



### 问卷星提交订单

#### 接口请求

| 接口说明     | 问卷星提交订单：检查图片的合法性并创建订单                   |
| :----------- | :----------------------------------------------------------- |
| **传输方式** | https                                                        |
| **请求方法** | POST                                                         |
| **请求格式** | Content-Type: application/x-www-form-urlencoded; charset=UTF-8 |
| **请求地址** | https://119.3.159.148:12345/wjx_order_pre/                   |
| **响应格式** | JSON                                                         |

#### 接口请求参数

| 参数名称     | 类型     | 是否必填 | 参数说明         |
| :----------- | :------- | :------- | :--------------- |
| (Cookie:SID) | cookie   | 是       | 携带的SID Cookie |
| formdata     | formdata | 是       | 二维码图片数据流 |

#### 接口响应参数

| 参数名称 | 类型   | 参数说明                                                     |
| :------- | :----- | :----------------------------------------------------------- |
| Code     | int    | **1000：订单成功**<br />1001：识别失败<br />2000：身份验证失败 |
| Message  | string | 识别失败时附加的报错信息                                     |
| order    | string | 订单相关信息的JSON对象                                       |



# 系统环境变量

## 前端

DEV = 

## 后端

DEV = 

SQL_PATH = 

ALI_ACCESS_KEY_ID = 

ALI_ACCESS_KEY_SECRET = 


## 任务端

DEV = 0

